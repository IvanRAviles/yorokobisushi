<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yorokobi Sushi — Menú</title>
  <style>
    :root{
      --bg:#0b0b0d;
      --panel:#121216;
      --panel2:#16161c;
      --text:#f3f3f5;
      --muted:#b8b8c2;
      --red:#b3001b;
      --red2:#7a0012;
      --line:rgba(255,255,255,.08);
      --shadow: 0 10px 30px rgba(0,0,0,.55);
      --radius:18px;
      --radius2:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 400px at 20% 0%, rgba(179,0,27,.18), transparent 55%),
        radial-gradient(700px 300px at 85% 10%, rgba(179,0,27,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }

    .top{
      display:flex; align-items:center; gap:14px;
      padding:16px 18px;
      border-bottom:1px solid var(--line);
      background: rgba(0,0,0,.22);
      backdrop-filter: blur(10px);
    }
.logoBox{
  width:40px;
  height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-shrink:0;
}

.logoBox img{
  width:40px;
  height:40px;
  object-fit:contain;
}


    .brand h1{margin:0; font-size:26px; line-height:1.1}
    .brand .sub{margin-top:4px; color:var(--muted); font-size:13px}

    .layout{
      max-width:1200px;
      margin:0 auto;
      padding:16px;
      display:grid;
      grid-template-columns: 260px 1fr 320px;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHeader{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      font-weight:800;
      letter-spacing:.08em;
      text-transform:uppercase;
      font-size:13px;
    }
    .cardBody{padding:12px 14px 14px;}

    /* Sections list */
    .secBtn{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color:var(--text);
      cursor:pointer;
      text-align:left;
      font-weight:700;
      margin-bottom:10px;
    }
    .secBtn.active{
      border-color: rgba(179,0,27,.55);
      background: linear-gradient(180deg, rgba(179,0,27,.18), rgba(0,0,0,.18));
    }

    /* Menu middle */
    .search{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      margin-bottom:12px;
    }
    .gallery{
      display:flex;
      gap:10px;
      overflow:auto;
      padding-bottom:6px;
      margin-bottom:12px;
    }
    .gallery img{
      height:92px;
      width:auto;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:#0e0e12;
      flex:0 0 auto;
    }

    .item{
      padding:12px 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      border-radius:16px;
      margin-bottom:12px;
    }
    .itemTop{
      display:flex; justify-content:space-between; gap:12px;
      align-items:flex-start;
    }
    .itemName{font-weight:900; line-height:1.2}
    .price{font-weight:900; color:#fff; opacity:.95; white-space:nowrap}
    .meta{color:var(--muted); font-size:13px; line-height:1.45; margin-top:6px}
    .warn{
      margin-top:8px;
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(179,0,27,.35);
      background: rgba(179,0,27,.10);
      color:#ffd7dd;
      font-size:13px;
      white-space:pre-line;
    }

    /* Right column */
    select{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      margin-top:10px;
    }
    .waBtn{
      width:100%;
      margin-top:12px;
      border:none;
      border-radius:14px;
      padding:14px 14px;
      font-size:16px;
      font-weight:900;
      color:white;
      background: linear-gradient(180deg, var(--red), var(--red2));
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(179,0,27,.22);
    }
    .small{color:var(--muted); font-size:13px; line-height:1.5}

  </style>
</head>
<body>

<header class="topBar">
  <div class="brandRow">
    <img class="logoMark" src="assets/logo-mark.png" alt="Yorokobi Sushi">
    <div class="brandText">
      <div class="brandName">Yorokobi Sushi</div>
      <div class="brandSub">Desde 2017</div>
    </div>
  </div>
</header>


    </div>
      <h1>Yorokobi Sushi</h1>
      <div class="sub">Desde 2017</div>
    </div>
  </div>

  <div class="layout">
    <!-- Left: sections -->
    <div class="card">
      <div class="cardHeader">Secciones</div>
      <div class="cardBody" id="sections"></div>
    </div>

    <!-- Middle: menu -->
    <div class="card">
      <div class="cardHeader">Menú</div>
      <div class="cardBody">
        <input id="search" class="search" placeholder="Buscar en esta sección..." />
        <div id="gallery" class="gallery" aria-label="Galería"></div>
        <div id="items"></div>
        <div id="empty" class="small" style="display:none; padding-top:6px;">
          No se encontraron resultados.
        </div>
      </div>
    </div>

    <!-- Right: locations -->
    <div class="card">
      <div class="cardHeader">Sucursales</div>
      <div class="cardBody">
        <div class="small">Selecciona una sucursal para ver el WhatsApp correcto.</div>
        <select id="loc"></select>
        <button class="waBtn" id="wa">Ordenar por WhatsApp</button>
        <div class="small" style="margin-top:10px;">
          * Aquí no hay pagos ni carrito. Solo muestra el menú y manda a WhatsApp.
        </div>
      </div>
    </div>
  </div>

<script>
  // 1) Put your real WhatsApp links here (we’ll set them next)
const LOCATIONS = [
  { id:"carranza",  name:"Sucursal Carranza",  wa:"https://wa.me/526862098003" },
  { id:"anahuac",   name:"Sucursal Anáhuac",   wa:"https://wa.me/526862220922" },
  { id:"industrial",name:"Sucursal Industrial",wa:"https://wa.me/526861971397" }
];


  // 2) Section-to-images folder mapping (based on your folder names)
  const IMAGE_FOLDERS = {
    "ARROCES DE LA CASA": "ARROCES",
    "CHAROLAS": "CHAROLAS",
    "ROLLOS EMPANIZADOS": "EMPANIZADOS",
    "ENTRADAS": "ENTRADAS",
    "ESPECIALIDADES DE LA CASA": "ESPECIALIDADES DE LA CASA",
    "ROLLOS HORNEADOS": "HORNEADOS",
    "MARISCOS": "MARISCOS",
    "NATURALES": "NATURALES",
    "TERIYAKI": "TERIYAKI",
  };

  // Auto-load sequential images like: FOLDER-1.JPG, FOLDER-2.JPG ... (stops after misses)
  async function loadGallery(sectionTitle){
    const el = document.getElementById("gallery");
    el.innerHTML = "";

    const folder = IMAGE_FOLDERS[sectionTitle];
    if(!folder) return;

    // build the base prefix exactly like your filenames, e.g. ARROCES-DE-LA-CASA-
    // We’ll try to match the folder name style when possible:
    const prefixMap = {
      "ARROCES": "ARROCES-DE-LA-CASA-",
      "CHAROLAS": "CHAROLAS-",
      "EMPANIZADOS": "ROLLOS-EMPANIZADOS-",
      "ENTRADAS": "ENTRADAS-",
      "ESPECIALIDADES DE LA CASA": "ESPECIALIDADES-DE-LA-CASA-",
      "HORNEADOS": "ROLLOS-HORNEADOS-",
      "MARISCOS": "MARISCOS-",
      "NATURALES": "NATURALES-",
      "TERIYAKI": "TERIYAKI-",
    };
    const prefix = prefixMap[folder];
    if(!prefix) return;

    let misses = 0;
    for(let i=1; i<=30; i++){
      const src = `assets/images/${folder}/${prefix}${i}.JPG`;
      const ok = await new Promise(res=>{
        const img = new Image();
        img.onload = () => res(true);
        img.onerror = () => res(false);
        img.src = src;
      });
      if(!ok){
        misses++;
        if(misses >= 3) break; // stop after 3 missing images in a row
        continue;
      }
      misses = 0;
      const imgEl = document.createElement("img");
      imgEl.src = src;
      imgEl.alt = sectionTitle;
      el.appendChild(imgEl);
    }
  }

  function slug(s){
    return (s||"").toLowerCase()
      .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
      .replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");
  }

  async function main(){
    // Locations
    const locSel = document.getElementById("loc");
    LOCATIONS.forEach(l=>{
      const o=document.createElement("option");
      o.value=l.id; o.textContent=l.name;
      locSel.appendChild(o);
    });
    const waBtn = document.getElementById("wa");
    function updateWA(){
      const chosen = LOCATIONS.find(x=>x.id===locSel.value) || LOCATIONS[0];
      waBtn.onclick = ()=> window.open(chosen.wa, "_blank", "noopener");
    }
    locSel.value = LOCATIONS[0].id;
    updateWA();
    locSel.addEventListener("change", updateWA);

    // Load menu.json
    const res = await fetch("assets/data/menu.json", { cache:"no-store" });
    const data = await res.json();

    // Expect: { "sections": [ { "title": "...", "items": [...] }, ... ] }
    const sections = (data.sections || []).map(s => ({
      title: s.title,
      items: s.items || []
    }));

    // Render sections
    const secEl = document.getElementById("sections");
    secEl.innerHTML = "";
    sections.forEach((s, idx)=>{
      const b=document.createElement("button");
      b.className="secBtn" + (idx===0 ? " active":"");
      b.textContent = s.title;
      b.onclick=()=>{
        document.querySelectorAll(".secBtn").forEach(x=>x.classList.remove("active"));
        b.classList.add("active");
        selectSection(s.title);
      };
      secEl.appendChild(b);
    });

    const search = document.getElementById("search");
    const itemsEl = document.getElementById("items");
    const emptyEl = document.getElementById("empty");
    let currentTitle = sections[0]?.title || "";

    function render(){
      const q = (search.value||"").trim().toLowerCase();
      const sec = sections.find(x=>x.title===currentTitle);
      const list = (sec?.items || []).filter(it=>{
        const hay = [
          it.name, it.ingredients, it.warning,
          (it.price||""),
          ...(it.price_options||[]).map(p=>`${p.label} ${p.price}`)
        ].join(" ").toLowerCase();
        return !q || hay.includes(q);
      });

      itemsEl.innerHTML = "";
      emptyEl.style.display = list.length ? "none" : "block";

      list.forEach(it=>{
        const div=document.createElement("div");
        div.className="item";

        const priceText =
          it.price ||
          (it.price_options && it.price_options.length ? "Ver opciones" : "");

        div.innerHTML = `
          <div class="itemTop">
            <div class="itemName">${it.name || ""}</div>
            <div class="price">${priceText}</div>
          </div>
          ${it.ingredients ? `<div class="meta"><b>Ingredientes:</b> ${it.ingredients}</div>` : ""}
          ${(it.price_options && it.price_options.length) ? `
            <div class="meta"><b>Opciones:</b><br>
              ${it.price_options.map(p=>`• ${p.label}: <b>${p.price}</b>`).join("<br>")}
            </div>` : ""
          }
          ${it.warning ? `<div class="warn">${it.warning}</div>` : ""}
        `;
        itemsEl.appendChild(div);
      });
    }

    async function selectSection(title){
      currentTitle = title;
      search.value = "";
      await loadGallery(title);
      render();
    }

    search.addEventListener("input", render);

    // Initial
    await selectSection(currentTitle);
  }

  main().catch(err=>{
    console.error(err);
    alert("Error cargando el menú. Revisa que assets/data/menu.json exista.");
  });
</script>

</body>
</html>



